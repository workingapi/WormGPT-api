# WormGPT Qwen API - High-Volume Deployment Configuration
# For handling millions/billions of requests

# === Server Configuration ===
PORT=4100
NODE_ENV=production

# === Domain Configuration ===
DOMAIN=your-project.railway.app
PROTOCOL=https
PUB_PORT=443

# === AI Provider Configuration - HIGH VOLUME SETUP ===

# CRITICAL: Add MULTIPLE API keys (comma-separated) for unlimited requests
# Each key can handle ~20 requests/minute, so:
# - 1 key = 20 req/min
# - 10 keys = 200 req/min
# - 100 keys = 2,000 req/min
# - 1000 keys = 20,000 req/min
# For millions of requests, use 50,000+ keys across multiple OpenRouter accounts

# Example:
# OPENROUTER_API_KEYS=sk-or-key1,sk-or-key2,sk-or-key3,sk-or-key4,sk-or-key5

# Primary (fallback if KEYS not set)
OPENROUTER_API_KEY=your_primary_api_key

# === Rate Limiting Configuration ===

# Default tier (no API key): requests per minute per IP
RATE_LIMIT_DEFAULT=100

# Premium tier (with API key): requests per minute
RATE_LIMIT_PREMIUM=1000

# Unlimited tier (internal): requests per minute
RATE_LIMIT_UNLIMITED=100000

# === Caching Configuration ===

# Enable response caching (reduces API calls by 40-60%)
CACHE_ENABLED=true

# Cache TTL in seconds (1 hour default)
CACHE_TTL=3600

# === Redis Configuration (REQUIRED for distributed scaling) ===

# Railway Redis connection (add Redis plugin to your Railway project)
# Format: redis://default:password@host:port
REDIS_URL=redis://localhost:6379

# === Context Management ===

# Maximum context length to use (reserve tokens for response)
# For 32K models: 30000
# For 128K models: 120000
MAX_CONTEXT_LENGTH=30000

# Maximum messages to keep in conversation history
MAX_CONVERSATION_MESSAGES=50

# === Horizontal Scaling ===

# Number of replicas (Railway auto-scales based on CPU/memory)
# Set in Railway dashboard or use auto-scaling
REPLICA_COUNT=1

# Region for deployment
REGION=us-east-1

# === Performance Tuning ===

# Enable response compression
COMPRESSION_ENABLED=true

# Maximum request size (in bytes)
MAX_REQUEST_SIZE=1048576

# Request timeout (milliseconds)
REQUEST_TIMEOUT=120000

# === Monitoring ===

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# Enable detailed metrics
METRICS_ENABLED=true

# === Security ===

# JWT secret for sessions (generate random 32+ chars)
JWT_SECRET=generate_a_very_long_random_secret_here_min_32_chars

# Cookie name
COOKIE_NAME=wormgpt-session

# CORS origin (* for all, or specify your domain)
CORS_ORIGIN=*

# === Optional: Advanced Features ===

# Enable request queuing for traffic spikes
REQUEST_QUEUING_ENABLED=true

# Maximum queue size
MAX_QUEUE_SIZE=10000

# Queue timeout (ms)
QUEUE_TIMEOUT=30000

# === Load Balancing ===

# Health check interval (ms)
HEALTH_CHECK_INTERVAL=10000

# Unhealthy threshold
UNHEALTHY_THRESHOLD=3

# === Database (Optional - for analytics) ===
# DATABASE_URL=postgresql://user:password@host:5432/dbname
